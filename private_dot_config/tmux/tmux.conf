set -g mouse on
set -s set-clipboard on
set -g default-terminal "tmux-256color"

# -- Index Settings --
set -g base-index 1
setw -g pane-base-index 1

# -- Pane Border --
set -g pane-border-style "fg=#868686"
set -g pane-active-border-style "fg=#A7F3D0"

# -- Window/Tab --
set -g renumber-windows on
set -g window-active-style 'fg=terminal,bg=terminal'
set -g window-style 'bg=#211f22,fg=#bebebe'

# -- Title --
set-option -g automatic-rename on
set-option -g automatic-rename-format ""

# -- Status Bar --
set -g status on
set -g status-style "bg=#3c3a3c,fg=#fcfcfa"
set -g status-position top
set -g status-interval 1

set -g status-justify left    # left|centre|right|absolute-centre :contentReference[oaicite:1]{index=1}
set -g status-left  " #[fg=colour250]#S #[bold]|#[default]"
set -g status-left-length 20
set -g window-status-separator " "
set -g window-status-format        " #[fg=colour250]#I: #W#[default]"
set -g window-status-current-format " #[bold]( #I: #W )#[default]"
set -g window-status-activity-style "fg=yellow"
set -g window-status-bell-style     "fg=red,bold"
set -g status-right "#[bold] #{client_key_table} #[fg=colour250]%H:%M:%S #{battery_icon} #{battery_percentage} "


set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-battery'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

set -g @continuum-restore 'on'
set -g @continuum-save-interval '15'

run '~/.config/tmux/plugins/tpm/tpm'

set -g command-alias[100] "tpm_install=run-shell ~/.config/tmux/plugins/tpm/bindings/install_plugins"
set -g command-alias[101] "tpm_update=run-shell ~/.config/tmux/plugins/tpm/bindings/update_plugins"
set -g command-alias[102] "tpm_clean=run-shell ~/.config/tmux/plugins/tpm/bindings/clean_plugins"
set -g command-alias[103] "save=run-shell ~/.config/tmux/plugins/tmux-resurrect/scripts/save.sh"
set -g command-alias[104] "restore=run-shell ~/.config/tmux/plugins/tmux-resurrect/scripts/restore.sh"
set -g command-alias[105] "stop_panes=run-shell '~/.config/tmux/stop-all-panes.sh'"

# ==========================
# ===== KeyBindings ========
# ==========================
unbind -a
unbind -a -T root

set -g prefix C-b
bind -T prefix C-b switch-client -T my_control
bind -T my_control Escape switch-client -T root
bind -T prefix C-q run-shell '~/.config/tmux/stop-all-panes.sh kill-server'
bind -T prefix q run-shell '~/.config/tmux/stop-all-panes.sh kill-server'

bind -T prefix C-v switch-client -T switch_pane
bind -T switch_pane Escape switch-client -T root

# -- Vim Mode --
setw -g mode-keys vi
bind -T prefix [ copy-mode
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send -X copy-selection-and-cancel
bind -T copy-mode-vi C-v send -X rectangle-toggle

# -- Splits --
bind -T my_control C-l split-window -h
bind -T my_control C-h split-window -h \; swap-pane -s !
bind -T my_control C-j split-window -v
bind -T my_control C-k split-window -v \; swap-pane -s !

# -- Navigate Panes --
bind -T prefix C-l select-pane -R
bind -T prefix C-h select-pane -L
bind -T prefix C-j select-pane -D
bind -T prefix C-k select-pane -U

# -- Resize Panes --
bind -T prefix H switch-client -T my_resize \; resize-pane -L 5
bind -T prefix J switch-client -T my_resize \; resize-pane -D 1
bind -T prefix K switch-client -T my_resize \; resize-pane -U 1
bind -T prefix L switch-client -T my_resize \; resize-pane -R 5
bind -T prefix ) switch-client -T my_resize \; select-layout -E

bind -T my_resize H resize-pane -L 5 \; switch-client -T my_resize
bind -T my_resize J resize-pane -D 1 \; switch-client -T my_resize
bind -T my_resize K resize-pane -U 1 \; switch-client -T my_resize
bind -T my_resize L resize-pane -R 5 \; switch-client -T my_resize
bind -T my_resize ) select-layout -E \; switch-client -T my_resize

# -- Window/Tab title --
bind -T prefix C-u command-prompt -I "#W" "rename-window '%%'"

# -- New Window/Tab --
bind -T prefix C-n new-window
bind -T prefix C-w kill-window
bind -T prefix w kill-window

# -- Moving Window/Tab --
bind -T my_control C-i switch-client -T my_tab_move \; swap-window -d -t -1
bind -T my_control i switch-client -T my_tab_move \; swap-window -d -t -1
bind -T my_control C-o switch-client -T my_tab_move \; swap-window -d -t +1
bind -T my_control o switch-client -T my_tab_move \; swap-window -d -t +1
bind -T my_tab_move C-i swap-window -d -t -1 \; switch-client -T my_tab_move
bind -T my_tab_move i swap-window -d -t -1 \; switch-client -T my_tab_move
bind -T my_tab_move C-o swap-window -d -t +1 \; switch-client -T my_tab_move
bind -T my_tab_move o swap-window -d -t +1 \; switch-client -T my_tab_move

# -- Select Window/Tab --
bind -T prefix C-i previous-window
bind -T prefix i previous-window
bind -T prefix C-o next-window
bind -T prefix o next-window

bind -T prefix C-1 select-window -t 1
bind -T prefix C-2 select-window -t 2
bind -T prefix C-3 select-window -t 3
bind -T prefix C-4 select-window -t 4
bind -T prefix C-5 select-window -t 5
bind -T prefix C-6 select-window -t 6
bind -T prefix C-7 select-window -t 7
bind -T prefix C-8 select-window -t 8
bind -T prefix C-9 select-window -t 9
bind -T prefix 1 select-window -t 1
bind -T prefix 2 select-window -t 2
bind -T prefix 3 select-window -t 3
bind -T prefix 4 select-window -t 4
bind -T prefix 5 select-window -t 5
bind -T prefix 6 select-window -t 6
bind -T prefix 7 select-window -t 7
bind -T prefix 8 select-window -t 8
bind -T prefix 9 select-window -t 9

# -- Select Window/Tab --
bind-key S 
bind -T my_control C-n "run-shell ~/.config/tmux/new-session.sh"
bind -T my_control C-u command-prompt -I "#S" -p "Rename session to:" "rename-session '%%'"
bind -T prefix C-s choose-tree -Zs
bind -T prefix s choose-tree -Zs

# -- Misc --
bind -T my-control I run-shell ~/.config/tmux/plugins/tpm/bindings/clean_plugins \; run-shell ~/.config/tmux/plugins/tpm/bindings/install_plugins \; run-shell ~/.config/tmux/plugins/tpm/bindings/clean_plugins
bind -T prefix : command-prompt
bind -T root C-BSpace send-keys Escape '[127;5u'
bind -n C-Tab send-keys Escape '[9;5u'

# -- Mouse --
bind-key -T root MouseDown1Pane select-pane -t = \; send-keys -M
bind-key -T root MouseDown1Status switch-client -t =
bind-key -T root MouseDown1ScrollbarUp copy-mode -u
bind-key -T root MouseDown1ScrollbarDown copy-mode -d
bind-key -T root MouseDown2Pane select-pane -t = \; if-shell -F "#{||:#{pane_in_mode},#{mouse_any_flag}}" { send-keys -M } { paste-buffer -p }
bind-key -T root MouseDown3Pane if-shell -F -t = "#{||:#{mouse_any_flag},#{&&:#{pane_in_mode},#{?#{m/r:(copy|view)-mode,#{pane_mode}},0,1}}}" { select-pane -t = ; send-keys -M } { display-menu -T "#[align=centre]#{pane_index} (#{pane_id})" -t = -x M -y M "#{?#{m/r:(copy|view)-mode,#{pane_mode}},Go To Top,}" < { send-keys -X history-top } "#{?#{m/r:(copy|view)-mode,#{pane_mode}},Go To Bottom,}" > { send-keys -X history-bottom } '' "#{?mouse_word,Search For #[underscore]#{=/9/...:mouse_word},}" C-r { if-shell -F "#{?#{m/r:(copy|view)-mode,#{pane_mode}},0,1}" "copy-mode -t=" ; send-keys -X -t = search-backward -- "#{q:mouse_word}" } "#{?mouse_word,Type #[underscore]#{=/9/...:mouse_word},}" C-y { copy-mode -q ; send-keys -l "#{q:mouse_word}" } "#{?mouse_word,Copy #[underscore]#{=/9/...:mouse_word},}" c { copy-mode -q ; set-buffer "#{q:mouse_word}" } "#{?mouse_line,Copy Line,}" l { copy-mode -q ; set-buffer "#{q:mouse_line}" } '' "#{?mouse_hyperlink,Type #[underscore]#{=/9/...:mouse_hyperlink},}" C-h { copy-mode -q ; send-keys -l "#{q:mouse_hyperlink}" } "#{?mouse_hyperlink,Copy #[underscore]#{=/9/...:mouse_hyperlink},}" h { copy-mode -q ; set-buffer "#{q:mouse_hyperlink}" } '' "Horizontal Split" h { split-window -h } "Vertical Split" v { split-window -v } '' "#{?#{>:#{window_panes},1},,-}Swap Up" u { swap-pane -U } "#{?#{>:#{window_panes},1},,-}Swap Down" d { swap-pane -D } "#{?pane_marked_set,,-}Swap Marked" s { swap-pane } '' Kill X { kill-pane } Respawn R { respawn-pane -k } "#{?pane_marked,Unmark,Mark}" m { select-pane -m } "#{?#{>:#{window_panes},1},,-}#{?window_zoomed_flag,Unzoom,Zoom}" z { resize-pane -Z } }
bind-key -T root MouseDown3Status display-menu -T "#[align=centre]#{window_index}:#{window_name}" -t = -x W -y W "#{?#{>:#{session_windows},1},,-}Swap Left" l { swap-window -t :-1 } "#{?#{>:#{session_windows},1},,-}Swap Right" r { swap-window -t :+1 } "#{?pane_marked_set,,-}Swap Marked" s { swap-window } '' Kill X { kill-window } Respawn R { respawn-window -k } "#{?pane_marked,Unmark,Mark}" m { select-pane -m } Rename n { command-prompt -F -I "#W" { rename-window -t "#{window_id}" "%%" } } '' "New After" w { new-window -a } "New At End" W { new-window }
bind-key -T root MouseDown3StatusLeft display-menu -T "#[align=centre]#{session_name}" -t = -x M -y W Next n { switch-client -n } Previous p { switch-client -p } '' Renumber N { move-window -r } Rename n { command-prompt -I "#S" { rename-session "%%" } } '' "New Session" s { new-session } "New Window" w { new-window }
bind-key -T root MouseDrag1Pane if-shell -F "#{||:#{pane_in_mode},#{mouse_any_flag}}" { send-keys -M } { copy-mode -M }
bind-key -T root MouseDrag1ScrollbarSlider copy-mode -S
bind-key -T root MouseDrag1Border resize-pane -M
bind-key -T root WheelUpPane if-shell -F "#{||:#{alternate_on},#{pane_in_mode},#{mouse_any_flag}}" { send-keys -M } { copy-mode -e }
bind-key -T root WheelUpStatus previous-window
bind-key -T root WheelDownStatus next-window
bind-key -T root DoubleClick1Pane select-pane -t = \; if-shell -F "#{||:#{pane_in_mode},#{mouse_any_flag}}" { send-keys -M } { copy-mode -H ; send-keys -X select-word ; run-shell -d 0.3 ; send-keys -X copy-pipe-and-cancel }
bind-key -T root TripleClick1Pane select-pane -t = \; if-shell -F "#{||:#{pane_in_mode},#{mouse_any_flag}}" { send-keys -M } { copy-mode -H ; send-keys -X select-line ; run-shell -d 0.3 ; send-keys -X copy-pipe-and-cancel }
bind-key -T root M-MouseDown3Pane display-menu -T "#[align=centre]#{pane_index} (#{pane_id})" -t = -x M -y M "#{?#{m/r:(copy|view)-mode,#{pane_mode}},Go To Top,}" < { send-keys -X history-top } "#{?#{m/r:(copy|view)-mode,#{pane_mode}},Go To Bottom,}" > { send-keys -X history-bottom } '' "#{?mouse_word,Search For #[underscore]#{=/9/...:mouse_word},}" C-r { if-shell -F "#{?#{m/r:(copy|view)-mode,#{pane_mode}},0,1}" "copy-mode -t=" ; send-keys -X -t = search-backward -- "#{q:mouse_word}" } "#{?mouse_word,Type #[underscore]#{=/9/...:mouse_word},}" C-y { copy-mode -q ; send-keys -l "#{q:mouse_word}" } "#{?mouse_word,Copy #[underscore]#{=/9/...:mouse_word},}" c { copy-mode -q ; set-buffer "#{q:mouse_word}" } "#{?mouse_line,Copy Line,}" l { copy-mode -q ; set-buffer "#{q:mouse_line}" } '' "#{?mouse_hyperlink,Type #[underscore]#{=/9/...:mouse_hyperlink},}" C-h { copy-mode -q ; send-keys -l "#{q:mouse_hyperlink}" } "#{?mouse_hyperlink,Copy #[underscore]#{=/9/...:mouse_hyperlink},}" h { copy-mode -q ; set-buffer "#{q:mouse_hyperlink}" } '' "Horizontal Split" h { split-window -h } "Vertical Split" v { split-window -v } '' "#{?#{>:#{window_panes},1},,-}Swap Up" u { swap-pane -U } "#{?#{>:#{window_panes},1},,-}Swap Down" d { swap-pane -D } "#{?pane_marked_set,,-}Swap Marked" s { swap-pane } '' Kill X { kill-pane } Respawn R { respawn-pane -k } "#{?pane_marked,Unmark,Mark}" m { select-pane -m } "#{?#{>:#{window_panes},1},,-}#{?window_zoomed_flag,Unzoom,Zoom}" z { resize-pane -Z }
bind-key -T root M-MouseDown3Status display-menu -T "#[align=centre]#{window_index}:#{window_name}" -t = -x W -y W "#{?#{>:#{session_windows},1},,-}Swap Left" l { swap-window -t :-1 } "#{?#{>:#{session_windows},1},,-}Swap Right" r { swap-window -t :+1 } "#{?pane_marked_set,,-}Swap Marked" s { swap-window } '' Kill X { kill-window } Respawn R { respawn-window -k } "#{?pane_marked,Unmark,Mark}" m { select-pane -m } Rename n { command-prompt -F -I "#W" { rename-window -t "#{window_id}" "%%" } } '' "New After" w { new-window -a } "New At End" W { new-window }
bind-key -T root M-MouseDown3StatusLeft display-menu -T "#[align=centre]#{session_name}" -t = -x M -y W Next n { switch-client -n } Previous p { switch-client -p } '' Renumber N { move-window -r } Rename n { command-prompt -I "#S" { rename-session "%%" } } '' "New Session" s { new-session } "New Window" w { new-window }

run-shell ~/.config/tmux/plugins/tmux-battery/battery.tmux
